<!doctype html><html lang=ja><head><meta content=#454351 name=theme-color><meta content="width=device-width,initial-scale=0.1" name=viewport><link href=https://slnq.github.io/style.css rel=stylesheet><meta content=夏 name=description><link href=https://slnq.github.io/f.ico rel=icon><meta charset=utf-8><meta content=夏果 property=og:site_name><meta content=summary name=twitter:card><meta content=https://slnq.github.io/f.ico property=og:image><meta content=@natsuka_sili name=twitter:site><link href=https://slnq.github.io/atom.xml rel=alternate title=RSS type=application/rss+xml><title>夏果</title><body><header><div><span class=about id=hide>とは</span><a href=https://slnq.github.io id=title>夏果</a><a class=about href=https://slnq.github.io/about>とは</a></div><a class=tag href=https://slnq.github.io/tags/browser/><span class=emoji>🔖️</span>browser</a><a class=tag href=https://slnq.github.io/tags/design/><span class=emoji>🔖️</span>design</a><a class=tag href=https://slnq.github.io/tags/event/><span class=emoji>🔖️</span>event</a><a class=tag href=https://slnq.github.io/tags/film/><span class=emoji>🔖️</span>film</a><a class=tag href=https://slnq.github.io/tags/js/><span class=emoji>🔖️</span>JS</a><a class=tag href=https://slnq.github.io/tags/museum/><span class=emoji>🔖️</span>museum</a><a class=tag href=https://slnq.github.io/tags/rust/><span class=emoji>🔖️</span>Rust</a><a class=tag href=https://slnq.github.io/tags/stroll/><span class=emoji>🔖️</span>stroll</a><a class=tag href=https://slnq.github.io/tags/virtual/><span class=emoji>🔖️</span>virtual</a><a class=tag href=https://slnq.github.io/tags/wasm/><span class=emoji>🔖️</span>Wasm</a><a class=tag href=https://slnq.github.io/tags/wired/><span class=emoji>🔖️</span>Wired</a><a class=tag href=https://slnq.github.io/tags/zola/><span class=emoji>🔖️</span>Zola</a></header><meta content=article property=og:type><meta content="GitHub ActionsでTweet" property=og:title><meta content="ブログなどを書いても自信がないからsnsへの投稿などもしないのだけれどgoogle検索が機能しなくなっている今日において私自身もtwitterなどで検索をしそこで見つかった記事を読むなどもしているので検索機能が実装されている適当なsnsにタイトルとurlを投稿するのも良いのかなと思うようになってきているとはいえブログを書きgit pushしてgithub acrionsにbuildしてもらっている頃には書いていたことなんて忘れてしまうし覚えていたとして面倒でtweetなんてしないだろうし何よりも毎回自意識と戦っていては精神にも悪いのだからgithub acrionsにはついでにtweetまでを行ってもらおうという算段具体的なコードhttps://github.com/slnq/slnq.github.io/blob/main/.github/workflows/main.ymlTwitterapiの発行とかで色々と面倒がある調べても尚も微妙に躓いた点として権限を変更した後にAPI Key and SecretをRegenerateしなくては変更が適応されなかったりするという点具体的なコードは前述のymlにありテストに用いたコードが下記import tweepyclient = tweepy.Client(consumer_key=&amp;quot;API Key&amp;quot;,consumer_secret=&amp;quot;API Key Secret&amp;quot;,access_token=&amp;quot;Access_Token&amp;quot;,access_token_secret=&amp;quot;Access Token Secret&amp;quot;)client.create_tweet(text=&amp;quot;Hello World&amp;quot;)BlueSkyアカウント名とパスワードで投稿できるから楽import atprotoclient = atproto.Client(base_url=&amp;#x27;https:&amp;#x2F;&amp;#x2F;bsky.social&amp;#x27;)client.login(login=&amp;#x27;ACCOUNT NAME UNDER @&amp;#x27;,password=&amp;#x27;PASSWORD&amp;#x27;)client.send_post(&amp;#x27;Hello World&amp;#x27;)Misskey当初はノートの作成および削除の権限のみを有効にしていたがうまくいかなかったため全てを有効にしているfrom misskey import Misskeyapi = Misskey(&amp;#x27;misskey.io&amp;#x27;)api.token = &amp;#x27;TOKEN&amp;#x27;api.notes_create(text=&amp;#x27;Hello World&amp;#x27;)%  GitHub ActionsGitHub側にもたせた環境変数はenv: ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }}run: | python - &amp;lt;&amp;lt;EOF access_token=os.environ.get(&amp;quot;ACCESS_TOKEN&amp;quot;) EOFのように使えるのだがrun内で定義したものはrun: | tweet_content=&amp;quot;${second_line_content} ${post_url}&amp;quot; echo &amp;quot;TWEET_CONTENT=$tweet_content&amp;quot; &amp;gt;&amp;gt; $GITHUB_ENV export TWEET_CONTENT=&amp;quot;$tweet_content&amp;quot; python - &amp;lt;&amp;lt;EOF tweet_text = f&amp;quot;{os.environ.get(&amp;#x27;TWEET_CONTENT&amp;#x27;)}&amp;quot; EOFのようにする必要がある気がするexportの行はいらない気がするのだがいれてからはうまくいったし取り敢えずこのままにしているapiとかwebサービスとかって調べることばかりに時間がとられて本当に嫌い一応2024年のうちに自動でtweetしてしまう機能が追加されてしまったから25年は納得できる文章を書けるようにするか納得のラインを下げるかのどちらかが起こる" name=description><div class=single><div><div class=headline>GitHub ActionsでTweet <a rel="noopener noreferrer" class=link href=https://github.com/slnq/slnq.github.io/blob/main/.github/workflows/main.yml target=_blank>⧉</a></div><span class=page-date>2024.12.31</span><span class=page-tag> <a class=tag href=../../tags/wired/><span class=emoji>🔖️</span>Wired</a> </span><div class=page-content><p>ブログなどを書いても自信がないからsnsへの投稿などもしないのだけれどgoogle検索が機能しなくなっている今日において私自身もtwitterなどで検索をしそこで見つかった記事を読むなどもしているので検索機能が実装されている適当なsnsにタイトルとurlを投稿するのも良いのかなと思うようになってきている<p class=br><p>とはいえブログを書きgit pushしてgithub acrionsにbuildしてもらっている頃には書いていたことなんて忘れてしまうし覚えていたとして面倒でtweetなんてしないだろうし何よりも毎回自意識と戦っていては精神にも悪いのだからgithub acrionsにはついでにtweetまでを行ってもらおうという算段<p class=br><p>具体的なコード<br \><a href=https://github.com/slnq/slnq.github.io/blob/main/.github/workflows/main.yml>https://github.com/slnq/slnq.github.io/blob/main/.github/workflows/main.yml</a><h1 id=twitter>Twitter</h1><p>apiの発行とかで色々と面倒がある<br>調べても尚も微妙に躓いた点として権限を変更した後にAPI Key and SecretをRegenerateしなくては変更が適応されなかったりするという点<br>具体的なコードは前述のymlにありテストに用いたコードが下記<pre><code>import tweepy<br>client = tweepy.Client(consumer_key="API Key",<br>consumer_secret="API Key Secret",access_token="Access_Token",<br>access_token_secret="Access Token Secret")<br>client.create_tweet(text="Hello World")</code></pre><h1 id=bluesky>BlueSky</h1><p>アカウント名とパスワードで投稿できるから楽<pre><code>import atproto<br>client = atproto.Client(base_url='https://bsky.social')<br>client.login(login='ACCOUNT NAME UNDER @',password='PASSWORD')<br>client.send_post('Hello World')</code></pre><h1 id=misskey>Misskey</h1><p>当初はノートの作成および削除の権限のみを有効にしていたがうまくいかなかったため全てを有効にしている<pre><code>from misskey import Misskey<br>api = Misskey('misskey.io')<br>api.token = 'TOKEN'<br>api.notes_create(text='Hello World')%  </code></pre><h1 id=github-actions>GitHub Actions</h1><p>GitHub側にもたせた環境変数は<pre><code>env:<br> ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }}<br>run: |<br> python - &lt;&lt;EOF<br> access_token=os.environ.get("ACCESS_TOKEN")<br> EOF</code></pre><p>のように使えるのだがrun内で定義したものは<pre><code>run: |<br> tweet_content="${second_line_content} ${post_url}"<br> echo "TWEET_CONTENT=$tweet_content" >> $GITHUB_ENV<br> export TWEET_CONTENT="$tweet_content"<br> python - &lt;&lt;EOF<br> tweet_text = f"{os.environ.get('TWEET_CONTENT')}"<br> EOF</code></pre><p>のようにする必要がある気がする<br \><code>export</code>の行はいらない気がするのだがいれてからはうまくいったし取り敢えずこのままにしている<hr><p>apiとかwebサービスとかって調べることばかりに時間がとられて本当に嫌い<p class=br><p>一応2024年のうちに自動でtweetしてしまう機能が追加されてしまったから25年は納得できる文章を書けるようにするか納得のラインを下げるかのどちらかが起こる</p><br></div></div></div><footer><a href=https://slnq.github.io>表紙</a><a href=https://slnq.github.io/about/>紹介</a><a href=https://slnq.github.io/atom.xml>購読</a><a href=https://slnq.github.io/search/>全文</a><a href=https://slnq.github.io/links/>関連</a><a href=https://slnq.github.io/photos/>写真</a><a href=https://slnq.github.io/photols/>風景</a><a href=https://slnq.github.io/animation/>映像</a><a href=https://slnq.github.io/page/>短文</a></footer>